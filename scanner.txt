#include <WiFi.h>

String getEncryptionType(wifi_auth_mode_t encType) {
  switch (encType) {
    case WIFI_AUTH_OPEN: return "OPEN";
    case WIFI_AUTH_WEP: return "WEP";
    case WIFI_AUTH_WPA_PSK: return "WPA";
    case WIFI_AUTH_WPA2_PSK: return "WPA2";
    case WIFI_AUTH_WPA_WPA2_PSK: return "WPA/WPA2";
    case WIFI_AUTH_WPA2_ENTERPRISE: return "WPA2-ENT";
    case WIFI_AUTH_WPA3_PSK: return "WPA3";
    case WIFI_AUTH_WPA2_WPA3_PSK: return "WPA2/WPA3";
    default: return "UNKNOWN";
  }
}

void setup() {
  Serial.begin(115200);
  delay(1000);

  Serial.println("Init STA...");
  WiFi.mode(WIFI_STA);
  WiFi.disconnect(true);
  delay(300);
}

void loop() {
  Serial.println("\nStarting scan...");

  int n = WiFi.scanNetworks(false, true); // passive scan

  Serial.print("Found ");
  Serial.print(n);
  Serial.println(" networks");

  for (int i = 0; i < n; i++) {
    Serial.printf(
      "%2d: %-20s RSSI=%4d dBm  CH=%2d  ENC=%s\n",
      i + 1,
      WiFi.SSID(i).c_str(),
      WiFi.RSSI(i),
      WiFi.channel(i),
      getEncryptionType(WiFi.encryptionType(i)).c_str()
    );
  }

  WiFi.scanDelete();
  Serial.println("--------------------");

  delay(10000); 
}
